YUI.add("hermes-template-fluid-magic-tools",function(t,e){var a=t.Template.Handlebars.revive({1:function(t,e,a,l,n){return'\t\t<div class="share-link">\n\t\t\t'+t.escapeExpression((a.outlet||e&&e.outlet||a.helperMissing).call(null!=e?e:{},null!=e?e.shareView:e,{name:"outlet",hash:{},data:n}))+"\n\t\t</div>\n"},3:function(t,e,a,l,n){var i,s=null!=e?e:{},r=a.helperMissing,o=t.escapeExpression;return'\t\t\t<a class="edit-link" href="'+o("function"==typeof(i=null!=(i=a.editUrl||(null!=e?e.editUrl:e))?i:r)?i.call(s,{name:"editUrl",hash:{},data:n}):i)+'" title="'+o((a.intlMessage||e&&e.intlMessage||r).call(s,{name:"intlMessage",hash:{intlName:"photostream.EDIT_PHOTO_INFO"},data:n}))+'">\n\t\t\t\t<span class="fluid-edit-icon"></span>\n\t\t\t</a>\n'},compiler:[7,">= 4.0.0"],main:function(t,e,a,l,n){var i,s=null!=e?e:{},r=a.helperMissing,o=t.escapeExpression;return'<div class="fluid-centered fluid-magic-toolbar">\n\t<div class="primary-tools-container">\n\t\t'+o((a.outlet||e&&e.outlet||r).call(s,null!=e?e["photostream-filter-tools-view"]:e,{name:"outlet",hash:{},data:n}))+'\n\t</div>\n\n\t<div class="secondary-tools">\n'+(null!=(i=a.if.call(s,null!=e?e.shareView:e,{name:"if",hash:{},fn:t.program(1,n,0),inverse:t.noop,data:n}))?i:"")+"\t\t"+o((a.outlet||e&&e.outlet||r).call(s,null!=e?e["fluid-magic-slideshow-view"]:e,{name:"outlet",hash:{},data:n}))+"\n\t\t"+o((a.outlet||e&&e.outlet||r).call(s,null!=e?e["fluid-magic-search-view"]:e,{name:"outlet",hash:{},data:n}))+"\n\n"+(null!=(i=a.if.call(s,null!=e?e.displayEditLink:e,{name:"if",hash:{},fn:t.program(3,n,0),inverse:t.noop,data:n}))?i:"")+"\t</div>\n</div>\n"},useData:!0}),l={};t.Array.each([],function(e){var a=t.Template.get("hermes/"+e);a&&(l[e]=a)}),t.Template.register("hermes/fluid-magic-tools",function(e,n){return n=n||{},n.partials=n.partials?t.merge(l,n.partials):l,a(e,n)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("fluid-magic-tools-view",function(e){e.namespace("Views")[this.name]=e.Base.create("fluid-magic-tools-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.set("selected",""),this.set("isEmptyPage",e.isEmptyPage),e.subnavConfig&&e.subnavConfig.selected&&this.set("selected",e.subnavConfig.selected),this.ownerNsid=e.nsid,this.page=e.pageParams&&e.pageParams.nominalPage,this},loadState:function(){var i=this;return e.Promise.resolve(this.appContext.getModel("person-models",this.ownerNsid)).then(function(e){i.set("personModel",e)})},subviewConfig:{"fluid-share-photostream-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,parentViewName:this.name,disabled:function(e){return"photostream"!==this.get("selected")||e.isMobile}},"fluid-share-favorites-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,parentViewName:this.name,disabled:function(e){return"favorites"!==this.get("selected")||e.isMobile}},"photostream-filter-tools-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(){return"photostream"!==this.get("selected")||!this.appContext.getViewer().signedIn},additionalViewClasses:["primary-tools"]},"fluid-magic-search-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(){return!!this.get("isEmptyPage")},additionalViewClasses:["closed"]},"fluid-magic-slideshow-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(){return!!this.get("isEmptyPage")}}},buildContainer:function(){var i,t=this.appContext.getViewer(),s=t.signedIn&&t.nsid===this.ownerNsid,r=e.URLHelper.generatePersonUrls(this.get("personModel"));return i={shareView:this.getShareViewContainer(),displayEditLink:"photostream"===this.get("selected")&&s&&!this.get("isEmptyPage")&&this.appContext.flipper.isFlipped("enable-photostream-edit")},null!==this.appContext.getLocation().href.match(/\/photos\/[^\/]+\/page/)?i.editUrl=r.photostreamEdit+"/page"+this.page:i.editUrl=r.photostreamEdit,this.setContainerWithTemplate("fluid-magic-tools",i),this},getShareViewContainer:function(){var e="";return this.subviews["fluid-share-"+this.get("selected")+"-view"]&&(e=this.subviews["fluid-share-"+this.get("selected")+"-view"].get("container")),e}})},"@VERSION@",{requires:["flutil","flickr-view","flickr-promise","fluid-share-photostream-view","fluid-share-favorites-view","fluid-magic-slideshow-view","photostream-filter-tools-view","hermes-template-fluid-magic-tools"],langBundles:["share-modal","common","photostream"]});YUI.add("hermes-lang-photostream",function(r,a){r.Intl.add("hermes/photostream","en-US",{EDIT_CAMERAROLL_ORGANIZR:["Edit in <a href='","${camerarollUrl}","'>Camera Roll</a> or <a href='","${organizrUrl}","'>Organizr</a>"],EDIT_PHOTO_INFO:["Edit photo info"]})},"@VERSION@",{requires:["intl"]});YUI.add("hermes-template-fluid-chalkboard",function(n,l){var a=n.Template.Handlebars.revive({1:function(n,l,a,e,t){return" html-chalkboard"},3:function(n,l,a,e,t){return" subview-chalkboard"},5:function(n,l,a,e,t){return'<div class="close-x"></div>'},7:function(n,l,a,e,t){var r;return'\t\t<div class="head">\n\t\t\t<div class="title">\n'+(null!=(r=a.if.call(null!=l?l:{},null!=l?l.title:l,{name:"if",hash:{},fn:n.program(8,t,0),inverse:n.program(10,t,0),data:t}))?r:"")+"\t\t\t</div>\n\t\t</div>\n"},8:function(n,l,a,e,t){var r;return"\t\t\t\t\t"+n.escapeExpression("function"==typeof(r=null!=(r=a.title||(null!=l?l.title:l))?r:a.helperMissing)?r.call(null!=l?l:{},{name:"title",hash:{},data:t}):r)+"\n"},10:function(n,l,a,e,t){return"\t\t\t\t\t"+n.escapeExpression((a.renderTrustedMarkup||l&&l.renderTrustedMarkup||a.helperMissing).call(null!=l?l:{},null!=l?l.htmlTitle:l,{name:"renderTrustedMarkup",hash:{},data:t}))+"\n"},12:function(n,l,a,e,t){var r,s,i=null!=l?l:{};return'\t\t\t<div class="content text-only '+(null!=(r=a.if.call(i,null!=l?l.noScroll:l,{name:"if",hash:{},fn:n.program(13,t,0),inverse:n.noop,data:t}))?r:"")+'">\n\t\t\t\t'+n.escapeExpression("function"==typeof(s=null!=(s=a.textMessage||(null!=l?l.textMessage:l))?s:a.helperMissing)?s.call(i,{name:"textMessage",hash:{},data:t}):s)+"\n\t\t\t</div>\n"},13:function(n,l,a,e,t){return" no-scroll"},15:function(n,l,a,e,t){var r,s=null!=l?l:{};return'\t\t\t<div class="content html-only '+(null!=(r=a.if.call(s,null!=l?l.noScroll:l,{name:"if",hash:{},fn:n.program(13,t,0),inverse:n.noop,data:t}))?r:"")+'">\n\t\t\t\t'+n.escapeExpression((a.renderTrustedMarkup||l&&l.renderTrustedMarkup||a.helperMissing).call(s,null!=l?l.htmlMessage:l,{name:"renderTrustedMarkup",hash:{},data:t}))+"\n\t\t\t</div>\n"},17:function(n,l,a,e,t){var r;return'\t\t\t<div class="content subview '+(null!=(r=a.if.call(null!=l?l:{},null!=l?l.noScroll:l,{name:"if",hash:{},fn:n.program(13,t,0),inverse:n.noop,data:t}))?r:"")+'"></div>\n'},19:function(n,l,a,e,t){var r;return'<button class="small action"'+(null!=(r=a.if.call(null!=l?l:{},null!=(r=null!=(r=null!=l?l.buttons:l)?r.action:r)?r.disabled:r,{name:"if",hash:{},fn:n.program(20,t,0),inverse:n.noop,data:t}))?r:"")+">"+n.escapeExpression(n.lambda(null!=(r=null!=(r=null!=l?l.buttons:l)?r.action:r)?r.label:r,l))+"</button>"},20:function(n,l,a,e,t){return' disabled="disabled"'},compiler:[7,">= 4.0.0"],main:function(n,l,a,e,t){var r,s,i=null!=l?l:{};return'<div class="chalkboard'+(null!=(r=a.if.call(i,null!=l?l.htmlMessage:l,{name:"if",hash:{},fn:n.program(1,t,0),inverse:n.noop,data:t}))?r:"")+(null!=(r=a.if.call(i,null!=l?l.subview:l,{name:"if",hash:{},fn:n.program(3,t,0),inverse:n.noop,data:t}))?r:"")+" "+n.escapeExpression("function"==typeof(s=null!=(s=a.classList||(null!=l?l.classList:l))?s:a.helperMissing)?s.call(i,{name:"classList",hash:{},data:t}):s)+'">\n\t'+(null!=(r=a.if.call(i,null!=l?l.showCancelX:l,{name:"if",hash:{},fn:n.program(5,t,0),inverse:n.noop,data:t}))?r:"")+"\n"+(null!=(r=a.if.call(i,null!=l?l.showHeader:l,{name:"if",hash:{},fn:n.program(7,t,0),inverse:n.noop,data:t}))?r:"")+'\t<div class="body">\n'+(null!=(r=a.if.call(i,null!=l?l.textMessage:l,{name:"if",hash:{},fn:n.program(12,t,0),inverse:n.noop,data:t}))?r:"")+(null!=(r=a.if.call(i,null!=l?l.htmlMessage:l,{name:"if",hash:{},fn:n.program(15,t,0),inverse:n.noop,data:t}))?r:"")+(null!=(r=a.if.call(i,null!=l?l.subview:l,{name:"if",hash:{},fn:n.program(17,t,0),inverse:n.noop,data:t}))?r:"")+'\t</div>\n\t<div class="foot">\n\t\t<div class="buttons">\n\t\t\t'+(null!=(r=a.if.call(i,null!=(r=null!=(r=null!=l?l.buttons:l)?r.action:r)?r.visible:r,{name:"if",hash:{},fn:n.program(19,t,0),inverse:n.noop,data:t}))?r:"")+"\n\t\t</div>\n\t</div>\n</div>\n"},useData:!0}),e={};n.Array.each([],function(l){var a=n.Template.get("hermes/"+l);a&&(e[l]=a)}),n.Template.register("hermes/fluid-chalkboard",function(l,t){return t=t||{},t.partials=t.partials?n.merge(e,t.partials):e,a(l,t)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("fluid-chalkboard-view",function(e,t){"use strict";var i,n,s=require("hermes-core/flog")(t);i={css:{destinationContainer:"body",closeX:".close-x",buttonAction:"button.action",subviewContent:".content.subview",modalContent:".content"},options:{}},n={supportsTransform:!1,modal:{height:0,width:0}},e.namespace("Views").FluidChalkboard=e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.set("isActiveViewAgnostic",!0),this.alreadyShowingModal=e.OverlayManager.ChalkboardOverlay.alreadyShowingModal("fluid-chalkboard-view"),this.alreadyShowingModal||e.OverlayManager.ChalkboardOverlay.add(this),this},activate:function(){var t=this.get("container"),n=this;return this.get("showCancelX")&&this.registerEventHandler(t.one(i.css.closeX).on("click",e.bind(this.handleAction,this))),this.get("showActionButton")&&this.registerEventHandler(t.one(i.css.buttonAction).on("click",e.bind(this.handleAction,this))),this.registerEventHandler(e.on("history:change",function(e){"popstate"===e.src&&e.prevVal&&e.newVal&&(e.prevVal.flickr&&e.prevVal.flickr.referrer||e.newVal.flickr&&e.newVal.flickr.referrer)||n.close(e)})),this.registerEventHandler(e.globalEvents.subscribe("window:resize",function(e){n.reposition()})),this.get("subview")&&(n.get("subview").activate(),n.registerEventHandler(n.get("subview").on("actionClick",e.bind(n.handleAction,n)))),this.fire("activated"),this},show:function(){return this.initialize().then(null,function(e){s.error("Error initializing modal",{err:e})}),this.isClosed=!1,this.freeze(),e.fire("flickr:setKeyEventScope",this.getKeyEventScope()),this},freeze:function(){e.one("body").setStyles({overflow:"hidden"})},unfreeze:function(){e.one("body").setStyles({overflow:"visible"})},enableActionButton:function(){var e=this.get("container").one(i.css.buttonAction);e&&e.getAttribute("disabled")&&e.removeAttribute("disabled")},disableActionButton:function(){var e=this.get("container").one(i.css.buttonAction);e&&e.setAttribute("disabled",!0)},buildContainer:function(){if(!this.alreadyShowingModal){var t=this,o=e.one(i.css.destinationContainer);this.setContainerWithTemplate("fluid-chalkboard",{showHeader:this.get("showHeader"),title:this.get("title"),htmlTitle:this.get("htmlTitle"),textMessage:this.get("textMessage"),htmlMessage:this.get("message")?this.get("message"):this.get("htmlMessage"),subview:!!this.get("subview"),hideModalOverlay:this.get("hideModalOverlay"),darkOverlay:this.get("darkOverlay"),showCancelX:this.get("showCancelX"),buttons:{visible:this.get("showButtons"),action:{visible:this.get("showActionButton"),label:this.get("actionButtonLabel"),disabled:this.get("actionButtonDisabled")}},classList:this.get("classList")}),n.modal.width=this.get("width"),n.modal.minWidth=this.get("minWidth"),n.modal.height=this.get("height"),this.get("subview")?(this.get("subview").appContext=t.appContext,this.get("subview").set("isActiveViewAgnostic",!0),this.get("subview").initialize().then(function(e){t.on("parentViewEvent",function(t){t&&t.details&&t.details.length&&e.fire.apply(e,["parentViewEvent"].concat(t.details))}),e.on("subviewViewEvent",function(e){e&&e.details&&e.details.length&&t.fire.apply(t,e.details)}),t.get("container").one(i.css.subviewContent).appendChild(e.get("container")),o&&(o.append(t.get("container")),t.reposition()),t.activate()},function(e){s.error("Error initializing modal subview",{err:e})})):o&&(o.append(this.get("container")),this.reposition())}return this},reposition:function(){var t,s,o,a,l,r=this.get("container").one(".chalkboard"),h=e.one(e.config.win),d=parseInt(h.get("innerWidth"),10),c=parseInt(h.get("innerHeight"),10),u=n.modal.width?parseInt(n.modal.width,10):parseInt(r.getComputedStyle("width"),10),g={},v=0,w={};n.modal.height&&(this.get("showHeader")&&(v=parseInt(r.one(".head").getComputedStyle("height"),10)),l=n.modal.height,n.modal.height+v+80>=c&&(l=c-v-80),r.setStyles({maxHeight:"none"}),this.get("fullWindow")?w.height=l+"px":this.get("maxHeight")&&(w.maxHeight=l+"px"),r.one(i.css.modalContent).setStyles(w)),t=this._getMiddleXPositionOfScreen(d,u),s=parseInt(r.getComputedStyle("height"),10),o=r.getDOMNode().scrollHeight,a=r.getDOMNode().scrollWidth,g={top:this._getMiddleYPositionOfScreen(c,s)+"px",left:t+"px",width:n.modal.width?u+"px":"",minWidth:n.modal.minWidth?n.modal.minWidth+"px":""},s+40>c||o>s+1||u+40>d||a>u?(g.top=e.DOM.docScrollY()+5+"px",g.maxHeight=c-40+"px",g.maxWidth=d-40+"px",g.overflow="auto"):(g.maxHeight="inherit",g.maxWidth="inherit",g.overflow="visible"),r.setStyles(g)},_getMiddleXPositionOfScreen:function(t,i){return Math.round(t/2)-Math.round(i/2)+e.DOM.docScrollX()},_getMiddleYPositionOfScreen:function(t,i){return Math.round(t/2)-Math.round(i/2)+e.DOM.docScrollY()},handleAction:function(e){this.fire("actionClick",e),this.get("dismissOnActionClick")&&this.close(e)},close:function(t){e.fire("flickr:removeKeyEventScope",this.getKeyEventScope());var i=this.get("container");this.isClosed=!0,e.one("body").removeClass("scroll-fluid-chalkboard"),this.get("subview")&&this.get("subview").destroy(),i&&i.remove(!0),this.fire("close",t),this.destroy(),e.OverlayManager.ChalkboardOverlay.remove(this)},getKeyEventScope:function(){return this.name+this._yuid},destructor:function(){this.unfreeze(),this.detachAll()}},{ATTRS:{showCancelX:{value:!1},showActionButton:{value:!0},hideModalOverlay:{value:!1},darkOverlay:{value:!1},actionButtonLabel:{value:"OK"},actionButtonDisabled:{value:!1},showButtons:{value:!0},dismissOnOverlayClick:{value:!1},dismissOnActionClick:{value:!0},message:{value:null},textMessage:{value:null},htmlMessage:{value:null},width:{value:0},minWidth:{value:0},height:{value:0},subview:{value:null},classList:{value:""},showHeader:{value:!1},title:{value:null},htmlTitle:{value:null},maxHeight:{value:!0}}})},"@VERSION@",{requires:["flickr-view","hermes-template-fluid-chalkboard","fluid-overlay-manager-view"],optionalRequires:["fluid"],langBundles:["common"]});YUI.add("jsonp",function(e,t){function r(){this._init.apply(this,arguments)}var n=e.Lang.isFunction;r.prototype={_init:function(t,r){this.url=t,this._requests={},this._timeouts={},r=n(r)?{on:{success:r}}:r||{};var i=r.on||{};i.success||(i.success=this._defaultCallback(t,r)),this._config=e.merge({context:this,args:[],format:this._format,allowCache:!1},r,{on:i})},_defaultCallback:function(){},send:function(){function u(e,r){return n(e)?function(n){var o=!0,u="_requests";r?(++t._timeouts[s],--t._requests[s]):(t._requests[s]||(o=!1,u="_timeouts"),--t[u][s]),!t._requests[s]&&!t._timeouts[s]&&delete YUI.Env.JSONP[s],o&&e.apply(i.context,[n].concat(i.args))}:null}var t=this,r=e.Array(arguments,0,!0),i=t._config,s=t._proxy||e.guid(),o;return i.allowCache&&(t._proxy=s),t._requests[s]===undefined&&(t._requests[s]=0),t._timeouts[s]===undefined&&(t._timeouts[s]=0),t._requests[s]++,r.unshift(t.url,"YUI.Env.JSONP."+s),o=i.format.apply(t,r),i.on.success?(YUI.Env.JSONP[s]=u(i.on.success),e.Get.js(o,{onFailure:u(i.on.failure),onTimeout:u(i.on.timeout,!0),timeout:i.timeout,charset:i.charset,attributes:i.attributes,async:i.async}).execute(),t):t},_format:function(e,t){return e.replace(/\{callback\}/,t)}},e.JSONPRequest=r,e.jsonp=function(t,n){var r=new e.JSONPRequest(t,n);return r.send.apply(r,e.Array(arguments,2,!0))},YUI.Env.JSONP||(YUI.Env.JSONP={})},"3.16.0",{requires:["get","oop"]});
YUI.add("digital-river-helper",function(e){"use strict";var i=require("superagent"),t=require("superagent-jsonp"),r=require("url-parse");e.DigitalRiverHelper=function(i){this.appContext=i.appContext||!1,this.storeBaseURL=e.config.flickr.digitalRiver.storeBaseUrl,this.proLandingPageUrl="/account/upgrade/pro"},e.DigitalRiverHelper.prototype.getAnalyticsBeaconsPrefix=function(){return"[DR] "},e.DigitalRiverHelper.prototype.getClientSideSessionToken=function(){var t=e.config.flickr.digitalRiver.clientSessionTokenUrl;return e.Cookie.remove("JSESSIONID",{path:"/",domain:e.config.flickr.digitalRiver.storeBaseUrl}),e.Cookie.remove("VISITOR_ID",{path:"/",domain:e.config.flickr.digitalRiver.storeBaseUrl}),i.get(t).then(function(e){return e.body.session_token}.bind(this)).catch(function(e){return e})},e.DigitalRiverHelper.prototype.getClientSideSessionTokenJSONP=function(){var r=e.config.flickr.digitalRiver.clientSessionTokenUrl,n=e.config.flickr.digitalRiver.logoutUrl;return i.get(n).use(t({timeout:1e4,callbackName:"drLogout"+(new Date).getTime()})).then(function(e){return i.get(r).use(t({timeout:1e4,callbackName:"drSessionToken"+(new Date).getTime()})).then(function(e){return e.body.session_token})})},e.DigitalRiverHelper.prototype.postHGOP=function(i){var t=e.config.flickr.digitalRiver.HGOPUrl,r=document.createElement("form");r.method="POST",r.action=t;var n=document.createElement("input");n.value=i,n.type="hidden",n.name="message",r.appendChild(n),document&&(document.body.appendChild(r),r.submit())},e.DigitalRiverHelper.prototype.getAPISessionRedirectUrl=function(i){return i=this.setDREnv(i),e.config.flickr.digitalRiver.userManagementPageBaseUrl+"APISessionRedirect?url="+encodeURIComponent(i)},e.DigitalRiverHelper.prototype.createCartAndGetStoreURL=function(i){return this.appContext.callAPI("flickr.digital.river.subscriptions.addProductToCart",i).then(function(t){if(t&&t.cartPayload)return{cartPayload:t.cartPayload};if(t&&t.redirectUrl){var r=t.redirectUrl+"&currency="+i.currency+"&fproUrl="+i.fProUrl;return this.sanitizeRedirectUrl(r)}return e.url(this.proLandingPageUrl)}.bind(this)).catch(function(e){throw e})},e.DigitalRiverHelper.prototype.initializeSessionOnDR=function(e){return this.appContext.callAPI("flickr.digital.river.subscriptions.initializeSession",e).then(function(e){return!0}.bind(this)).catch(function(e){throw e})},e.DigitalRiverHelper.prototype.sanitizeRedirectUrl=function(i){var t=new r(i);if("https:"===t.protocol&&t.hostname===this.storeBaseURL){return this.setDREnv(i)}return console.log("checkout url validation failed"),e.url("/account")},e.DigitalRiverHelper.prototype.getRedirectUrlToUpdatePaymentMethod=function(i,t){var r=e.config.flickr.digitalRiver.userManagementPageBaseUrl+t+"/DisplayUpdateAddressPaymentInfoPage/";return r+="?billingOptionID="+i.getValue("details").paymentVendorCreditCardToken,this.getAPISessionRedirectUrl(r)},e.DigitalRiverHelper.prototype.getRedirectUrlToCreatePaymentMethod=function(i,t){var r="https://"+e.config.flickr.digitalRiver.storeBaseUrl+"/store?Action=DisplayAddEditAddressPaymentPage&Locale=en_US&SiteID=flickr&fpredirect=no&Env=DESIGN&StyleEnv=DESIGN";return this.getAPISessionRedirectUrl(r)},e.DigitalRiverHelper.prototype.setDREnv=function(e){return this.appContext.flipper.isFlipped("enable-digital-river-design-env")?e+="&ENV=DESIGN":e},e.DigitalRiverHelper.prototype.getRedirectUrlToInvoicePage=function(i,t){i=i||"";var r=e.config.flickr.digitalRiver.userManagementPageBaseUrl+t+"/DisplayInvoicePage/?requisitionID="+i;return this.getAPISessionRedirectUrl(r)},e.DigitalRiverHelper.prototype.beaconError=function(i,t){if(!YUI.Env.isServer&&e.config.win.beaconError){var r={UA:("undefined"!=typeof navigator&&navigator.userAgent||"").toString(),signedIn:1,message:i};t&&(r=e.merge(r,t)),e.config.win.beaconError("[digital-river] ",e.config.win.location.href,r)}},e.DigitalRiverHelper.prototype.parseCartAction=function(e){var i="";if(e)switch(e){case"edit":case"update":case"purchase":case"optin":i=e;break;default:i=null}else i=null;return i}},"@VERSION@",{requires:["array-extras","jsonp","cookie"],optional:[],optionalRequires:["superagent"]});YUI.add("empty-page-view",function(e,t){var i=require("hermes-core/flog")(t),a=(new e.SubscriptionsHelper,{small:{width:60,size:"s"},medium:{width:125,size:"q"},large:{width:240,size:"m"}});e.namespace("Views")[this.name]=e.Base.create("empty-page-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){var i;return this.page=t.page,this.subPage=t.subPage,this.viewAs=t.viewAs,this.isSlow=t.isSlow,"cameraroll"===this.page&&(this.subPage=t.mapType),t.nsid||(t.nsid=this.appContext.getViewer().nsid),this.nsid=t.nsid,this.displayName=t.displayName,this.isHelloPro=t.isHelloPro,this.isCamerarollPhotostream=t.isCamerarollPhotostream,t.subnavConfig={selected:this.isCamerarollPhotostream?"cameraroll":this.page},t.isEmptyPage=!0,t.numItemsUploadedForNotification=5,t.willNavigateAfterInitialUpload=!0,i=YUI.Env.isServer?e.BrowserSupport.getOSString(this.appContext.request.headers["user-agent"]):e.UA.os,this.showMacBanner="macintosh"===i,this.showWindowsBanner="windows"===i,this.showUploadrBanner=(this.showMacBanner||this.showWindowsBanner)&&!e.StorageHelper.getItem("hasDismissedCameraRollUploaderBanner")&&this.isYou(this.nsid),this.appContext.flipper.isFlipped("disable-uploadr-ads")&&(this.showUploadrBanner=!1),this.needToShowWelcomeVideo=!0,YUI.Env.isServer||e.StorageHelper.getItem("hasSeenWelcomeVideo")&&(this.needToShowWelcomeVideo=!1),this.geo=t.geo||!1,this},subviewConfig:{"global-nav-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"fluid-photostream-coverphoto-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"fluid-magic-subnav-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"fluid-magic-tools-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(){return!this.isYou(this.nsid)&&"photostream"!==this.page}},"cameraroll-tools-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,additionalViewClasses:function(){return["restyle"]},disabled:function(){return"cameraroll"!==this.page}},"footer-full-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"uploader-minimal-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disabled:function(){return"cameraroll"!==this.page}}},loadState:function(){return e.Promise.resolve()},isYou:function(e){return this.appContext.getViewer().nsid===e},generateFakeDateTitle:function(t,i,a){return"zh-HK"===this.appContext.lang?t+" 年 "+i+" 月 "+a+" 日":this.intlMessage({intlName:"cameraroll.DATE_TITLE",intlDate:e.moment(t+"-"+i+"-"+a,"YYYY-MM-DD").toDate()})},buildContainer:function(){var t={},i=600,a=50,o=this.appContext.viewportData.getHeight()-50-250-70-109;return"cameraroll"===this.page?(a=4,o-=50,i=Math.max(450,o)-a-1):"albums"===this.page?i=Math.max(450,o)-a-1+46:"photostream"===this.page?(this.isYou(this.nsid)&&(o-=50),i=Math.max(450,o)-a-1+46):"favorites"===this.page?i=Math.max(450,o)-a-1+46:"galleries"===this.page&&(i=Math.max(450,o)-a-1+46),"cameraroll"===this.page&&(t.twentyfifteen=2015,t.twentyfourteen=2014,t.march=this.intlMessage({intlName:"common."+e.moment("2015-03-01").format("MMMM").toUpperCase()}),t.april=this.intlMessage({intlName:"common."+e.moment("2015-04-01").format("MMMM").toUpperCase()}),t.aprilthirty=this.generateFakeDateTitle(2015,4,30),t.marchone=this.generateFakeDateTitle(2015,3,1),t.decemberthirteen=this.generateFakeDateTitle(2014,12,13),t.decembertwelve=this.generateFakeDateTitle(2014,12,12),t.octoberthirtyone=this.generateFakeDateTitle(2014,10,31),t.octobertwentyfour=this.generateFakeDateTitle(2014,10,24)),this.setContainerWithTemplate("empty-page",{"fluid-header":this.subviews["fluid-photostream-coverphoto-view"]?this.subviews["fluid-photostream-coverphoto-view"].get("container"):"",page:this.page,"the-page":this.templates("empty-page-"+this.page)({displayName:this.displayName,isYou:this.isYou(this.nsid),viewAs:this.viewAs,fakeDates:t,subPage:this.subPage,minHeight:i,isSlow:this.isSlow,isCamerarollPhotostream:this.isCamerarollPhotostream}),isYou:this.isYou(this.nsid),showUploadrBanner:this.showUploadrBanner,isMac:this.showMacBanner,isWindows:this.showWindowsBanner,isSlow:this.isSlow}),this},activate:function(){var t=e.one(".uploadr-banner-small");return"cameraroll"===this.page&&(this.cameraRollWidth=0,this.handleCamerarollResize(),this.needToShowWelcomeVideo&&!this.isSlow&&setTimeout(function(t,i){(i=new e.Views.FluidChalkboard({appContext:t.appContext,showHeader:!0,title:t.intlMessage({intlName:"cameraroll.WELCOME_TO_CAMERAROLL"}),dismissOnOverlayClick:!1,darkOverlay:!0,showCancelX:!0,actionButtonLabel:t.intlMessage({intlName:"photo-page.WELCOME_MSG_CONFIRM_BUTTON"}),subview:new e.Views["welcome-video-view"]({appContext:this.appContext}),classList:"chalkboard-welcome-video"})).on("actionClick",function(t){e.StorageHelper.setItem("hasSeenWelcomeVideo",!0)}),i.show()},2e3,this,void 0)),this.registerEventHandler(e.globalEvents.subscribe("window:resize",this.handleResize.bind(this))),t&&!this.isSlow&&(e.StorageHelper.getItem("hasDismissedCameraRollUploaderBanner")||(t.removeClass("is-hidden"),this.registerEventHandler(t.one(".butt").on("click",this.handleBannerDownload.bind(this))),e.rapidTracker.beacon(this.name,"showUploadrBanner"))),this.isHelloPro?this.appContext.getModel("person-models",this.nsid).then(function(t){if(this.showHelloProModal(t),this.appContext.flipper.isFlipped("enable-digital-river")){new e.DigitalRiverHelper({appContext:this.appContext}).getAnalyticsBeaconsPrefix()}}.bind(this)):this},onSubviewEvent:function(t,i){var a=i[0],o=this.appContext;"photostream:filter"===a?this.appContext.flapp.navigate(window.location.href):"initialUploadsComplete"===a?"cameraroll"===this.page&&e.Promise.all([o.getModelRegistry("cameraroll-tags-map-models"),o.getModelRegistry("cameraroll-dates-map-models"),o.getModelRegistry("person-profile-models")]).then(function(e){e.forEach(function(e){e.removeAll()}),o.flapp.navigate(o.getLocation().href)}):e.Env.isServer||"camerarollTools:sortOrder"!==a||this.sortOrderChange(i[1])},handleResize:function(e){"cameraroll"===this.page&&this.handleCamerarollResize(e);var t=600,i=0,a=this.appContext.viewportData.getHeight()-50-250-70-109,o=this.get("container").one(".empty-page"),s=".wrap";"cameraroll"===this.page?(i=4,a-=50,t=Math.max(450,a)-i-1,s=".copy"):"albums"===this.page?t=Math.max(450,a)-i-1+46:"photostream"===this.page?(a-=50,t=Math.max(450,a)-i-1+46):"favorites"===this.page?t=Math.max(450,a)-i-1+46:"galleries"===this.page&&(t=Math.max(450,a)-i-1+46),o.one(s)&&o.one(s).setStyles({minHeight:t+"px"})},handleCamerarollResize:function(e){var t,i,o,s=this.get("container").one(".height-controller"),r=s.all(".date-container .cameraroll-item-placeholder"),n=this.calculateCamerarollWidthAndMargin(),l=a.medium.width;this.cameraRollWidth!==n.width&&(this.cameraRollWidth=n.width,o=(t=this.cameraRollWidth)-((l+10)*(i=Math.floor((t+10)/(l+10)))-10),this.itemWidth=Math.max(l,l+o/i),s.all(".date-container").setStyles({width:t+10}),r.setStyles({width:this.itemWidth,height:this.itemWidth}),this.get("container").one(".mock-cameraroll").setStyles({display:"block"}))},sortOrderChange:function(e){var t,a=this;"date_posted"===e?t="dc":"date_taken"===e?t="dt":"autotags"===e&&(t="at"),this.appContext.callAPI("flickr.prefs.setPrefs",{camera_roll_view_pref:t}).then(function(){a.appContext.flapp.navigate("/cameraroll")},function(e){i.error("Error changing cameraroll tools pref",{err:e}),a.appContext.flapp.navigate("/cameraroll")})},calculateCamerarollWidthAndMargin:function(){var e,t,i=this.appContext.viewportData.getWidth();return t=Math.max(130,.1*i),e=Math.max(800,i-2*t),{margin:Math.round(t),width:Math.round(e)}},handleBannerDownload:function(t){var i=t.target.getAttribute("href");t.preventDefault(),e.rapidTracker.beacon(this.name,this.showMacBanner?"macUploaderBannerDownloadClick":"windowsUploaderBannerDownloadClick"),e.StorageHelper.setItem("hasDismissedCameraRollUploaderBanner",!0),this.get("container").one(".uploadr-banner-small").remove(),e.config.win.location=i},showHelloProModal:function(t){var i=e.URLHelper.generatePersonUrls(t),a=new e.Views.FluidModal({actionButtonLabel:this.intlMessage({intlName:"checkout.OK_THANKS"}),htmlMessage:this.templates("simplified-pro-hello-pro")({photostreamURL:e.url(i.photostream)}),showBodyLines:!0,showHeader:!1,appContext:this.appContext,dismissOnOverlayClick:!1,dismissOnActionClick:!0,actionButtonDisabled:!1,actionButtonIsDangerous:!1,showCancelButton:!1,hideModalOverlay:!1,classList:"welcome-pro-modal",showCancelX:!1});a.on("activated",function(t){var o=a.get("container").one(".freebrowsing"),s=a.get("container").one(".auto-uploadr"),r=a.get("container").one(".partners");o.on("click",function(t){e.config.win.location=e.url("/")}),s.on("click",function(t){e.config.win.location=e.url("/tools")}),r.on("click",function(t){e.config.win.location=e.url("/account")});var n=new Date;n.setTime(n.getTime()+2592e6),this.appContext.setCookie({cookieName:e.config.flickr.banners.dismiss_early_renewal_banner_name,cookieValue:1,expires:n,path:"/"}),setTimeout(function(){e.config.win.history.replaceState({},"",i.photostream)},1e3)}),a.on("actionClick",function(t){e.config.win.location=e.url(i.photostream)}),a.show()}},{ATTRS:{spaceid:{getter:function(){var e,t=this.page;return"cameraroll"===t?e=792600561:"photostream"===t?e=this.isSlow?792600603:792600537:"albums"===t?e=this.isSlow?792600604:792600578:"favorites"===t?e=this.isSlow?792600611:792600539:"creations"===t?e=792600585:"stats"===t?e=792600586:"galleries"===t&&(e=792600643),e}}}})},"@VERSION@",{requires:["flickr-view","flickr-promise","moment","hermes-template-empty-page","hermes-template-empty-page-cameraroll","hermes-template-empty-page-photostream","hermes-template-empty-page-albums","hermes-template-empty-page-favorites","hermes-template-empty-page-creations","hermes-template-empty-page-stats","hermes-template-empty-page-galleries","hermes-template-simplified-pro-hello-pro","welcome-video-view","global-nav-view","footer-full-view","hermes-template-flickr-balls","fluid-magic-tools-view","browser-support","fluid-chalkboard-view","url-helper","digital-river-helper","subscriptions-helper"],langBundles:["common","magic-empty-states","cameraroll","photo-page","checkout","photo-page-scrappy"]});YUI.add("hermes-lang-checkout",function(e,E){e.Intl.add("hermes/checkout","en-US",{APPLY_COUPON:["Apply"],ADD_COUPON_CODE:["Add coupon code"],REMOVE_COUPON:["Remove"],COUPON_CODE_PLACEHOLDER:["Coupon code"],COUPON_APPLIED:["Coupon code applied"],COUPON_EXPIRED_SAD:["This code expired :("],COUPON_NOT_VALID:["This code is not valid"],PLEASE_WAIT:["Please wait"],HELLO_PRO:["Hello, Pro!"],GET_STARTED_WITH_SUPERPOWERS:["Get started with your superpowers"],OK_THANKS:["Ok, thanks"],TRANSACTION_FAILED:["Transaction failed"],PROCESSING_PAYMENT:["Processing payment…"],PAYMENT_ERROR_PROCESSING:["The payment could not be processed. Check your payment details or use another payment method and try again."],RE_ENTER_PAYMENT_METHOD:["Re-enter payment method"],SHARE_YOUR_NEW_ADFREE_PHOTOSTREAM:["Share your new ad-free photostream"],COMPLETE_PURCHASE:["Complete purchase"],INPUT_CREDIT_CARD_NUMBER:["Credit card number"],INPUT_EXPIRATION_DATE:["Expiration date"],INPUT_SECURITY_CODE:["Security code"],INPUT_ZIP_CODE:["Zip code"],INPUT_COUNTRY:["Country"],INPUT_ZIP_POSTAL_CODE:["Zip/Postal code"],PLEASE_ENTER_VALID_CARD_NUMBER:["Please enter a valid card number"],PLEASE_SELECT_YEAR:["Please select a year"],PLEASE_SELECT_MONTH:["Please select a month"],PLEASE_SELECT_VALID_YEAR:["Please select a valid year"],PLEASE_SELECT_VALID_MONTH:["Please select a valid month"],PLEASE_ENTER_VALID_CVV:["Please select a valid security code"],PLEASE_ENTER_CORRECT_VALID_CVV:["Please enter a valid security code"],PLEASE_ENTER_VALID_ZIPCODE:["Please select a valid zip code"],PLEASE_ENTER_CORRECT_VALID_ZIPCODE:["Please enter a valid zip code"],PLEASE_SELECT_A_COUNTRY:["Please select a country"],PLEASE_ENTER_CORRECT_VALID_ZIPPOSTALCODE:["Please enter a valid zip or postal code"],PLAN_DETAIL_AD_FREE:["Ad-Free"],PLAN_DETAIL_AUTO_UPLOADER:["Auto-uploader"],PLAN_DETAIL_ADVANCED_STATISTICS:["Advanced statistics"],PLAN_ORIGINAL_PRICE:["Original Price"],PLAN_DETAIL_EXCLUSIVE_DISCOUNTS:["Exclusive discounts from Adobe, Blurb, Portfoliobox and Priime"],FLICKR_ANNUAL_PRO_PLAN:["Annual Plan"],FLICKR_MONTHLY_PRO_PLAN:["Monthly Plan"],CLICK_PAYPAL_LINK:["Click the button below to log in to Paypal and complete your purchase."],BUY_FLICKR_PRO:["Buy Flickr Pro"],GET_AUTO_UPLOADR:["Get Auto-Uploadr"],BROWSE_AD_FREE:["Browse Ad-Free"],VIEW_PARTNER_PERKS:["View partners perks"],"45_DAYS_TRIAL":["45-day free trial"],X_DAYS_TRIAL:["${days}","-day free trial"],BILLING_WILL_START_DATE:["Billing starts ","${date}"],REDIRECTING_YOU_TO_PARTNER_DR:["Redirecting you to our partner Digital River"],REDIRECTING_TO_PARTNER_DR:["Redirecting to our partner Digital River"],PLEASE_CONTACT_SUPPORT_PAYPAL:['Please <a href="',"${url}",'" target="_blank">contact us</a> to update your PayPal payment method'],PLEASE_CONTACT_SUPPORT_PAYMENT_METHOD:['Please <a href="',"${url}",'" target="_blank">contact us</a> to update your payment method'],PAYMENT_METHOD_TITLE:["Payment method"]})},"@VERSION@",{requires:["intl"]});